@if (!isLoading) {
  <main class="profile-page">
    <div class="container-fluid px-3 px-md-4 py-4">
      <!-- Page Header -->
      <header class="page-header">
        <h1 class="page-title">Môj profil</h1>
        <p class="page-subtitle">Správa vašich osobných údajov a prehľad dotazníka.</p>
      </header>

      <!-- Personal Info and Password Change Grid -->
      <div class="row g-4">
        <!-- Personal Information Section -->
        <div class="col-12 col-lg-6">
          <mat-card class="profile-card">
            <div class="profile-card-header">
              <div class="header-icon-wrapper icon-cyan">
                <mat-icon>person</mat-icon>
              </div>
              <h2 class="header-title">Osobné informácie</h2>
            </div>
            <mat-card-content class="profile-card-content">
              <div class="row g-4">
                <div class="col-12 col-sm-6">
                  <div class="info-item">
                    <div class="info-label">Meno</div>
                    <p class="info-value">{{ userData.firstName }}</p>
                  </div>
                </div>
                <div class="col-12 col-sm-6">
                  <div class="info-item">
                    <div class="info-label">Priezvisko</div>
                    <p class="info-value">{{ userData.lastName }}</p>
                  </div>
                </div>
                <div class="col-12 col-sm-6">
                  <div class="info-item">
                    <div class="info-label">Email</div>
                    <p class="info-value">{{ userData.email }}</p>
                  </div>
                </div>
                <div class="col-12 col-sm-6">
                  <div class="info-item">
                    <div class="info-label">Rola</div>
                    <p class="info-value">{{ userData.roles[0].name }}</p>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>

        <!-- Password Change Section -->
        <div class="col-12 col-lg-6">
          <mat-card class="profile-card">
            <div class="profile-card-header">
              <div class="header-icon-wrapper icon-orange">
                <mat-icon>lock</mat-icon>
              </div>
              <h2 class="header-title">Zmena hesla</h2>
            </div>
            <mat-card-content class="profile-card-content">
              <form [formGroup]="profileForm" (ngSubmit)="changePassword()" class="password-form">
                <div class="form-field-wrapper">
                  <mat-form-field appearance="outline" class="custom-form-field">
                    <mat-label>Pôvodné heslo</mat-label>
                    <input
                      matInput
                      type="password"
                      id="currentPassword"
                      formControlName="currentPassword"
                      required
                    />
                  </mat-form-field>
                </div>
                <div class="row g-3">
                  <div class="col-12 col-sm-6">
                    <mat-form-field appearance="outline" class="custom-form-field">
                      <mat-label>Nové heslo</mat-label>
                      <input
                        matInput
                        type="password"
                        id="newPassword"
                        formControlName="newPassword"
                        required
                      />
                    </mat-form-field>
                  </div>
                  <div class="col-12 col-sm-6">
                    <mat-form-field appearance="outline" class="custom-form-field">
                      <mat-label>Potvrdiť nové heslo</mat-label>
                      <input
                        matInput
                        type="password"
                        id="confirmNewPassword"
                        formControlName="confirmNewPassword"
                        required
                      />
                    </mat-form-field>
                  </div>
                </div>
                <div class="form-actions d-flex justify-content-end">
                  <button mat-raised-button color="primary" type="submit" class="submit-btn">
                    Zmeniť heslo
                  </button>
                </div>
              </form>
            </mat-card-content>
          </mat-card>
        </div>
      </div>

      <!-- Student Form Results Section -->
      @if (formData) {
        <div class="form-results-section" *appHasRole="[AuthRole.STUDENT]">
          <!-- Header with Edit Button -->
          <div class="results-header">
            <h2 class="results-title">
              <mat-icon class="title-icon">description</mat-icon>
              <span>Vyplnený dotazník</span>
            </h2>
            <button
              mat-raised-button
              color="primary"
              (click)="redirectToUserForm()"
              class="edit-btn">
              <mat-icon>edit</mat-icon>
              <span>Upraviť dotazník</span>
            </button>
          </div>

          <!-- User Form Results Component -->
          <app-user-form-results [existingAnswers]="formData" />
        </div>
      }
    </div>
  </main>
}
